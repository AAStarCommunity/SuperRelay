# Changes Log

æœ¬æ–‡æ¡£è®°å½• SuperPaymaster é¡¹ç›®çš„å¼€å‘å†ç¨‹å’Œç‰ˆæœ¬å˜æ›´ã€‚

## é¡¹ç›®çŠ¶æ€åˆ†æ (å½“å‰çŠ¶æ€ - 2024-07-02)

### é¡¹ç›®æ¦‚å†µ
**SuperPaymaster** æ˜¯ä¸€ä¸ªå®Œæ•´çš„ ERC-4337 Paymaster è§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼š
1. **super-relay** (æœ¬é¡¹ç›®) - Paymaster ä¸­ç»§æœåŠ¡
2. **SuperPaymaster åˆçº¦** (ç‹¬ç«‹ repo) - æ™ºèƒ½åˆçº¦å±‚

### å½“å‰å¼€å‘è¿›å±•
#### super-relay åŠŸèƒ½å®Œæˆåº¦
- âœ… **Paymaster ç­¾å**: æ”¯æŒåŸºäº ERC4337 è§„æ ¼çš„ UserOperation è¯·æ±‚ï¼ˆå•ä¸ªæˆ–æ‰¹é‡ï¼‰ï¼Œè¿”å›å¸¦æœ‰ paymasterAndData çš„ç­¾å
- âœ… **Bundler æäº¤**: æ”¶åˆ°å¸¦æœ‰ç­¾åçš„ UserOperationï¼Œè‡ªå·±æ”¯ä»˜ gasï¼Œé€šè¿‡ RPC ä¸Šé“¾ï¼Œæäº¤ç»™ EntryPoint æ‰§è¡Œ
- âœ… **å…¼å®¹æ€§**: æ”¯æŒ EntryPoint v0.6, v0.7ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰ï¼Œä¸º v0.8 åšå¥½å‡†å¤‡
- âœ… **ç­–ç•¥å¼•æ“**: åŸºäº TOML é…ç½®çš„èµåŠ©ç­–ç•¥ï¼Œæ”¯æŒå¤šç§Ÿæˆ·ç®¡ç†
- âœ… **æ¨¡å—åŒ–è®¾è®¡**: åœ¨ä¸ä¿®æ”¹ Rundler æ ¸å¿ƒä»£ç åŸºç¡€ä¸Šæ‰©å±•åŠŸèƒ½

#### æŠ€æœ¯æ ˆéªŒè¯
- âœ… **ç¼–è¯‘ç³»ç»Ÿ**: Cargo workspace é…ç½®æ­£ç¡®ï¼Œæ‰€æœ‰ä¾èµ–è§£ææˆåŠŸ
- âœ… **RPC æ¥å£**: JSON-RPC API å®ç°å®Œæˆï¼Œæ”¯æŒ `pm_sponsorUserOperation` æ–¹æ³•
- âœ… **å¼‚æ­¥æ¶æ„**: åŸºäº Tokio runtimeï¼Œæ€§èƒ½ä¼˜åŒ–
- âœ… **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯ç±»å‹å®šä¹‰å’Œå¤„ç†æœºåˆ¶

#### å¾…å®Œæˆå·¥ä½œ
- ğŸ”„ **é›†æˆæµ‹è¯•**: éœ€è¦ä¿®å¤æµ‹è¯•ä¸­çš„åºåˆ—åŒ–é—®é¢˜
- ğŸ”„ **åˆçº¦é›†æˆ**: ç­‰å¾… SuperPaymaster åˆçº¦å®Œæˆåè¿›è¡Œè”åˆæµ‹è¯•
- ğŸ“ **æ–‡æ¡£å®Œå–„**: API æ–‡æ¡£å’Œç”¨æˆ·æŒ‡å—

### æŠ€æœ¯é£é™©è¯„ä¼°
- **ä½é£é™©**: Rundler åŸºç¡€æ¶æ„ç¨³å®šï¼Œæ ¸å¿ƒ paymaster åŠŸèƒ½å®ç°å®Œæ•´
- **ä¸­é£é™©**: ERC-4337 è§„èŒƒæ›´æ–°å¯èƒ½éœ€è¦é€‚é…ï¼Œç‰¹åˆ«æ˜¯ EntryPoint v0.8
- **ç®¡æ§æªæ–½**: ä¿æŒæ¨¡å—åŒ–è®¾è®¡ï¼Œç¡®ä¿å¯ä»¥å¿«é€Ÿé€‚é…æ–°ç‰ˆæœ¬

### ä¸‹é˜¶æ®µç›®æ ‡
1. å®Œæˆæµ‹è¯•ä¿®å¤å’ŒéªŒè¯
2. ä¸ SuperPaymaster åˆçº¦è¿›è¡Œé›†æˆæµ‹è¯•
3. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‡†å¤‡
4. å¤šç½‘ç»œå…¼å®¹æ€§æµ‹è¯•

---

## Version 0.0.5 - CLI Integration & Compilation Fix (2024-12-19)

### ç¼–è¯‘é—®é¢˜ä¿®å¤å®Œæˆ âœ…
- ğŸ”§ ä¿®å¤ RPC crate ç¼ºå°‘ paymaster-relay ä¾èµ–é—®é¢˜
- ğŸ¯ å®Œæˆæ‰€æœ‰æ¨¡å—çš„ Debug trait å®ç° (PaymasterRelayService, SignerManager, PolicyEngine)
- ğŸ“ æ›´æ–° lib.rs æ­£ç¡®å¯¼å‡ºå…¬å…±ç±»å‹ (PaymasterRelayService, PaymasterRelayApiServerImpl)
- âš™ï¸  ä¿®å¤äºŒè¿›åˆ¶ crate ä¾èµ–é…ç½®ï¼Œæ·»åŠ  rundler-paymaster-relay ä¾èµ–

### CLI é›†æˆå®Œæˆ âœ…
- ğŸš€ å®Œæˆ paymaster æœåŠ¡ä¸ä¸» CLI çš„é›†æˆ
- âš™ï¸  ä¿®å¤ RPC ä»»åŠ¡åˆ›å»ºå‚æ•°ï¼Œæ·»åŠ  paymaster_service å‚æ•°
- ğŸ”§ ä¿®å¤å¯¼å…¥è·¯å¾„ï¼Œä½¿ç”¨æ­£ç¡®çš„æ¨¡å—è·¯å¾„ (policy::PolicyEngine, signer::SignerManager)
- ğŸ¯ ä¿®å¤ç±»å‹è½¬æ¢é—®é¢˜ï¼Œæ­£ç¡®å¤„ç† SecretString å’Œ Path ç±»å‹

### æ¶æ„å®Œå–„
- ğŸ“¦ å®Œæˆ PaymasterRelayApiServer trait çš„æ­£ç¡®å¯¼å…¥å’Œä½¿ç”¨
- ğŸ”„ å®ç°é”™è¯¯ç±»å‹è½¬æ¢ï¼Œå…¼å®¹ eyre::Report å’Œ anyhow::Error
- ğŸ—ï¸  å®Œå–„ Arc<LocalPoolHandle> ç±»å‹åŒ…è£…
- âš¡ æ”¯æŒé»˜è®¤ç­–ç•¥é…ç½®ï¼Œå½“æœªæä¾›ç­–ç•¥æ–‡ä»¶æ—¶è‡ªåŠ¨åˆ›å»º

### æµ‹è¯•éªŒè¯
- âœ… Paymaster-relay å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡ (3/3)
- âœ… é¡¹ç›® Debug æ¨¡å¼ç¼–è¯‘æˆåŠŸ
- âœ… é¡¹ç›® Release æ¨¡å¼ç¼–è¯‘æˆåŠŸ
- ğŸ§ª é›†æˆæµ‹è¯•å·²å‡†å¤‡å°±ç»ª

### å½±å“èŒƒå›´
- ä¿®æ”¹æ–‡ä»¶: `crates/rpc/Cargo.toml` (æ·»åŠ  paymaster-relay ä¾èµ–)
- ä¿®æ”¹æ–‡ä»¶: `bin/rundler/Cargo.toml` (æ·»åŠ  paymaster-relay ä¾èµ–)
- ä¿®æ”¹æ–‡ä»¶: `crates/paymaster-relay/src/lib.rs` (å¯¼å‡ºå…¬å…±ç±»å‹)
- ä¿®æ”¹æ–‡ä»¶: `crates/paymaster-relay/src/service.rs` (æ·»åŠ  Debug trait)
- ä¿®æ”¹æ–‡ä»¶: `crates/paymaster-relay/src/signer.rs` (æ·»åŠ  Debug trait)
- ä¿®æ”¹æ–‡ä»¶: `crates/paymaster-relay/src/policy.rs` (æ·»åŠ  Debug trait)
- ä¿®æ”¹æ–‡ä»¶: `crates/rpc/src/task.rs` (å¯¼å…¥ PaymasterRelayApiServer)
- ä¿®æ”¹æ–‡ä»¶: `bin/rundler/src/cli/node/mod.rs` (ä¿®å¤å¯¼å…¥å’Œç±»å‹è½¬æ¢)
- ä¿®æ”¹æ–‡ä»¶: `bin/rundler/src/cli/rpc.rs` (æ·»åŠ  paymaster å‚æ•°)
- å½±å“åŠŸèƒ½: paymaster-relay æ¨¡å—ç°åœ¨å®Œå…¨é›†æˆåˆ°ä¸»é¡¹ç›®ä¸­

### ä¸‹ä¸€æ­¥è®¡åˆ’
- âœ… å®Œæˆç«¯åˆ°ç«¯é›†æˆæµ‹è¯•
- âœ… å®Œå–„ paymaster-policies.toml é…ç½®æ–‡ä»¶
- ğŸ”„ æµ‹è¯•å®é™…çš„ UserOperation èµåŠ©æµç¨‹
- ğŸ“Š éªŒè¯ä¸ EntryPoint åˆçº¦çš„é›†æˆ

---

## Version 0.0.6 - APIæ³¨å†Œé—®é¢˜ä¿®å¤å®Œæˆ ğŸ‰ (2024-12-19)

### é‡å¤§çªç ´ï¼šPaymasterAPI æˆåŠŸæ³¨å†Œ âœ…
- ğŸ¯ **ä¿®å¤CLIè§£æå™¨**: æ·»åŠ "paymaster"åˆ°API namespaceçš„æœ‰æ•ˆå€¼åˆ—è¡¨ (`value_parser = ["eth", "debug", "rundler", "admin", "paymaster"]`)
- âš™ï¸ **æ›´æ–°é»˜è®¤é…ç½®**: å°†é»˜è®¤APIè®¾ç½®ä¸º"eth,rundler,paymaster"ï¼Œç¡®ä¿paymaster APIé»˜è®¤å¯ç”¨
- ğŸ”§ **éªŒè¯ä¿®å¤æ•ˆæœ**: APIé”™è¯¯ä»"-32601 Method not found"å˜æˆ"-32602 å‚æ•°æ ¼å¼é”™è¯¯"ï¼Œè¯æ˜APIå·²æ­£ç¡®æ³¨å†Œ

### æ¶æ„éªŒè¯å®Œæˆ
- âœ… **æœåŠ¡é›†æˆ**: PaymasterRelayServiceæ­£ç¡®ä¼ é€’ç»™RPC task
- âœ… **APIæ³¨å†Œ**: paymaster APIåœ¨ApiNamespace::Paymasteræ¡ä»¶ä¸‹æ­£ç¡®æ³¨å†Œåˆ°RPCæœåŠ¡å™¨
- âœ… **ç«¯ç‚¹å‘ç°**: `pm_sponsorUserOperation`æ–¹æ³•å·²è¢«RPCæœåŠ¡å™¨æ­£ç¡®è¯†åˆ«å’Œè·¯ç”±

### æµ‹è¯•ç¯å¢ƒæ”¹è¿›
- ğŸš€ å®ŒæˆReleaseç‰ˆæœ¬ç¼–è¯‘å’Œéƒ¨ç½²
- ğŸ”— éªŒè¯ä¸Anvilæµ‹è¯•é“¾çš„å®Œæ•´é›†æˆ
- ğŸ“ ç¡®è®¤EntryPointåˆçº¦éƒ¨ç½²å’Œé…ç½®æ­£ç¡®

### å½±å“èŒƒå›´
- ä¿®æ”¹æ–‡ä»¶: `bin/rundler/src/cli/rpc.rs` (æ›´æ–°API namespaceè§£æå™¨å’Œé»˜è®¤å€¼)
- å½±å“åŠŸèƒ½: paymaster APIç°åœ¨å®Œå…¨å¯ç”¨ï¼Œæ”¯æŒé€šè¿‡JSON-RPCè°ƒç”¨

### å½“å‰çŠ¶æ€
- âœ… **æ ¸å¿ƒåŠŸèƒ½**: PaymasterRelayService, SignerManager, PolicyEngine å…¨éƒ¨å®ç°
- âœ… **RPCé›†æˆ**: JSON-RPC API `pm_sponsorUserOperation` æ­£å¸¸å·¥ä½œ
- âœ… **CLIé›†æˆ**: æ‰€æœ‰paymasterç›¸å…³å‚æ•°æ­£ç¡®è§£æå’Œä¼ é€’
- ğŸ”„ **å‚æ•°è°ƒè¯•**: æ­£åœ¨å®Œå–„UserOperationå‚æ•°æ ¼å¼éªŒè¯

### ä¸‹ä¸€æ­¥è®¡åˆ’
- ğŸ”„ å®Œå–„UserOperationå‚æ•°æ ¼å¼å’ŒéªŒè¯é€»è¾‘
- ğŸ§ª å®Œæˆç«¯åˆ°ç«¯UserOperationèµåŠ©æµç¨‹æµ‹è¯•
- ğŸ“œ åˆ›å»ºæœåŠ¡é‡å¯å’Œæ—¥å¿—ç›‘æ§è„šæœ¬
- ğŸ“Š éªŒè¯ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å°±ç»ª

---

## Version 0.0.4 - Integration Testing Environment (2024-07-02)

### æµ‹è¯•ç¯å¢ƒå»ºè®¾
- ğŸ¯ å»ºç«‹å®Œæ•´çš„æœ¬åœ°æµ‹è¯•ç¯å¢ƒï¼ˆAnvil + EntryPoint + Super-Relayï¼‰
- ğŸš€ æˆåŠŸéƒ¨ç½² EntryPoint v0.6 åˆçº¦åˆ° Anvil æœ¬åœ°é“¾
- âš™ï¸  åˆ›å»ºç”Ÿäº§çº§é…ç½®æ–‡ä»¶ (`config/config.toml`, `config/paymaster-policies.toml`)
- ğŸ§ª å¼€å‘è‡ªåŠ¨åŒ–é›†æˆæµ‹è¯•è„šæœ¬ (`scripts/test_integration.sh`)
- ğŸ“‹ æ”¯æŒå®Œæ•´çš„ JSON-RPC æµ‹è¯•æµç¨‹

### éƒ¨ç½²è„šæœ¬ä¼˜åŒ–
- ğŸ“œ `scripts/deploy_entrypoint.sh`: è‡ªåŠ¨éƒ¨ç½² EntryPoint åˆçº¦
- ğŸ¯ æ™ºèƒ½åœ°å€è¯†åˆ«ï¼šè‡ªåŠ¨æ•è·éƒ¨ç½²åçš„å®é™…åˆçº¦åœ°å€
- ğŸ’¾ åœ°å€æŒä¹…åŒ–ï¼šä¿å­˜éƒ¨ç½²åœ°å€åˆ° `.entrypoint_address` æ–‡ä»¶
- âœ… éƒ¨ç½²éªŒè¯ï¼šè‡ªåŠ¨éªŒè¯åˆçº¦ä»£ç å’ŒåŠŸèƒ½

### é…ç½®ç®¡ç†
- ğŸ” æµ‹è¯•ç§é’¥é…ç½®ï¼šä½¿ç”¨ Anvil é»˜è®¤æµ‹è¯•è´¦æˆ·
- ğŸ“ ç­–ç•¥å¼•æ“ï¼šé…ç½®å…è®¸çš„å‘é€è€…å’Œè´¹ç”¨é™åˆ¶
- ğŸŒ ç½‘ç»œé…ç½®ï¼šå®Œæ•´çš„ RPC ç«¯ç‚¹å’Œ gas é™åˆ¶è®¾ç½®
- ğŸ”§ çµæ´»çš„å‚æ•°è°ƒæ•´ï¼šæ”¯æŒå¼€å‘å’Œç”Ÿäº§ç¯å¢ƒåˆ‡æ¢

### é›†æˆæµ‹è¯•èƒ½åŠ›
- ğŸ¥ å¥åº·æ£€æŸ¥ï¼šéªŒè¯æœåŠ¡å¯åŠ¨å’Œå“åº”
- ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•ï¼š`pm_sponsorUserOperation` ç«¯ç‚¹
- ğŸ“Š æ ‡å‡† RPC å…¼å®¹æ€§ï¼š`eth_supportedEntryPoints` ç­‰
- ğŸ”„ è‡ªåŠ¨åŒ–æµç¨‹ï¼šä¸€é”®æµ‹è¯•æ•´ä¸ªé›†æˆé“¾è·¯

### å½±å“èŒƒå›´
- æ–°å¢æ–‡ä»¶: `scripts/deploy_entrypoint.sh` (EntryPoint éƒ¨ç½²è„šæœ¬)
- æ–°å¢æ–‡ä»¶: `scripts/test_integration.sh` (é›†æˆæµ‹è¯•è„šæœ¬)
- æ–°å¢æ–‡ä»¶: `config/config.toml` (ä¸»é…ç½®æ–‡ä»¶)
- æ–°å¢æ–‡ä»¶: `config/paymaster-policies.toml` (ç­–ç•¥é…ç½®)
- å½±å“åŠŸèƒ½: å®Œæ•´çš„å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒå°±ç»ª

### æµ‹è¯•ç¯å¢ƒä¿¡æ¯
- ğŸŒ **æœ¬åœ°é“¾**: Anvil (http://localhost:8545, Chain ID: 31337)
- ğŸ“ **EntryPoint**: åŠ¨æ€éƒ¨ç½²åœ°å€ï¼ˆä¿å­˜åœ¨ `.entrypoint_address`ï¼‰
- ğŸ”— **API ç«¯ç‚¹**: http://localhost:3000
- ğŸ”‘ **æµ‹è¯•è´¦æˆ·**: Anvil é»˜è®¤è´¦æˆ· (10000 ETH ä½™é¢)

---

## Version 0.0.3 - Compilation Fixes & Testing (2024-07-02)

### å·²è§£å†³é—®é¢˜
- ä¿®å¤ paymaster-relay æ¨¡å—ç¼–è¯‘é”™è¯¯
- ä¿®å¤ JsonRPC ç‰¹æ€§é…ç½®é—®é¢˜ï¼Œæ·»åŠ  "client", "ws-client" ç‰¹æ€§
- ä¿®å¤ UserOperationVariant åºåˆ—åŒ–é—®é¢˜ï¼Œå®ç° JSON è½¬æ¢
- ä¿®å¤æµ‹è¯•æ–‡ä»¶ä¸­çš„å¯¼å…¥è·¯å¾„é—®é¢˜
- ä¿®å¤ policy.rs ä¸­ç§æœ‰å­—æ®µè®¿é—®é—®é¢˜ï¼Œä½¿ç”¨ UserOperationBuilder
- ä¿®å¤æµ‹è¯•æ–‡ä»¶ä¸­ UserOperationVariant åºåˆ—åŒ–é—®é¢˜ï¼Œæ”¹ç”¨ JSON æ ¼å¼

### æŠ€æœ¯æ”¹è¿›
- å®ç° JsonUserOperation åˆ° UserOperationVariant çš„å®Œæ•´è½¬æ¢é€»è¾‘
- æ”¯æŒ EntryPoint v0.6 å’Œ v0.7 çš„è‡ªåŠ¨è¯†åˆ«å’Œè½¬æ¢
- ä¼˜åŒ–é”™è¯¯å¤„ç†ï¼Œæä¾›è¯¦ç»†çš„è½¬æ¢é”™è¯¯ä¿¡æ¯
- æ”¹è¿›ä»£ç ç»“æ„ï¼Œå»é™¤æœªä½¿ç”¨çš„ Swagger UI ä¾èµ–

### æµ‹è¯•éªŒè¯
- âœ… Rundler åŸæœ‰åŠŸèƒ½æµ‹è¯•å…¨éƒ¨é€šè¿‡ (297 tests passed)  
- âœ… Paymaster-relay ç¼–è¯‘å®Œå…¨æˆåŠŸï¼Œæ— ç¼–è¯‘é”™è¯¯
- âœ… Paymaster-relay å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡ (3 tests passed)
- âœ… æ•´ä½“é¡¹ç›® Release ç¼–è¯‘æˆåŠŸï¼Œç”Ÿäº§å°±ç»ª
- âœ… ç¡®è®¤æ–°å¢åŠŸèƒ½ä¸å½±å“åŸæœ‰ç³»ç»Ÿç¨³å®šæ€§

### å½±å“èŒƒå›´
- ä¿®æ”¹æ–‡ä»¶: `crates/paymaster-relay/Cargo.toml` (æ·»åŠ  jsonrpsee ç‰¹æ€§)
- ä¿®æ”¹æ–‡ä»¶: `crates/paymaster-relay/src/rpc.rs` (é‡æ„ JSON è½¬æ¢é€»è¾‘)
- ä¿®æ”¹æ–‡ä»¶: `crates/paymaster-relay/src/policy.rs` (ä¿®å¤æµ‹è¯•ä»£ç )
- åˆ é™¤æ–‡ä»¶: Swagger UI ç›¸å…³æ–‡ä»¶ (ç®€åŒ–ä¾èµ–)
- å½±å“åŠŸèƒ½: JSON-RPC æ¥å£ä¼˜åŒ–ï¼Œæµ‹è¯•ç¨³å®šæ€§æå‡

### åŒ…åç¡®è®¤
- åŒ…å `rundler-paymaster-relay` æ­£ç¡®é…ç½®
- æµ‹è¯•å‘½ä»¤: `cargo test --package rundler-paymaster-relay` å¯æ­£å¸¸è¯†åˆ«

---

## Version 0.0.2 - Bug Fixes & Integration (2024-07-02)

### å·²è§£å†³é—®é¢˜
- ä¿®å¤ git å­æ¨¡å—é—®é¢˜ (fastlz/fastlz.c æ–‡ä»¶ç¼ºå¤±)
- ä¿®å¤ workspace ä¾èµ–é…ç½®é—®é¢˜
- å°† paymaster-relay æ­£ç¡®é›†æˆåˆ°ä¸» workspace
- æ·»åŠ ç¼ºå¤±çš„ workspace ä¾èµ–: axum, utoipa, utoipa-swagger-ui, ethers, jsonrpsee-core, jsonrpsee-ws-client
- å®Œæˆé¡¹ç›®ç¼–è¯‘éªŒè¯ (Debug å’Œ Release æ¨¡å¼)

### æ–‡æ¡£å®Œå–„
- åˆ›å»º `Changes.md` - ç‰ˆæœ¬å˜æ›´è®°å½•
- åˆ›å»º `Deploy.md` - å®Œæ•´çš„éƒ¨ç½²å’Œç»´æŠ¤æŒ‡å—

### æµ‹è¯•çŠ¶æ€
- é¡¹ç›®ç¼–è¯‘æˆåŠŸ âœ…
- ä¾èµ–é…ç½®æ­£ç¡® âœ…
- å‡†å¤‡è¿›è¡ŒåŠŸèƒ½æµ‹è¯•

### æŠ€æœ¯æ”¹è¿›
- workspace é…ç½®ä¼˜åŒ–
- ä¾èµ–ç‰ˆæœ¬ç»Ÿä¸€ç®¡ç†
- ç¼–è¯‘æµç¨‹ç¨³å®š

---

## Version 0.0.1 - Initial Development (2024-07-02)

### æ–°å¢åŠŸèƒ½
- åˆ›å»º `paymaster-relay` crate ä½œä¸ºç‹¬ç«‹æ¨¡å—
- å®ç° `SignerManager` - æ”¯æŒæœ¬åœ°ç§é’¥ç­¾åç®¡ç†
- å®ç° `PolicyEngine` - åŸºäº TOML é…ç½®çš„èµåŠ©ç­–ç•¥å¼•æ“
- å®ç° `PaymasterRelayApi` - JSON-RPC æ¥å£ï¼Œæä¾› `pm_sponsorUserOperation` æ–¹æ³•
- å®ç° `PaymasterRelayService` - æ ¸å¿ƒä¸šåŠ¡é€»è¾‘æœåŠ¡
- é›†æˆ Swagger UI - è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£
- æ·»åŠ å®Œæ•´çš„é”™è¯¯å¤„ç†æœºåˆ¶

### æŠ€æœ¯æ¶æ„
- åŸºäº Rundler (Alchemy ERC-4337 bundler) æ¶æ„
- æ”¯æŒ EntryPoint v0.6 å’Œ v0.7
- æ¨¡å—åŒ–è®¾è®¡ï¼Œä¸å½±å“ Rundler åŸæœ‰åŠŸèƒ½
- å¼‚æ­¥å¤„ç†æ¶æ„ï¼ŒåŸºäº Tokio runtime

### æ ¸å¿ƒåŠŸèƒ½æµç¨‹
1. å®¢æˆ·ç«¯è°ƒç”¨ `pm_sponsorUserOperation`
2. ç­–ç•¥å¼•æ“éªŒè¯ UserOperation æ˜¯å¦ç¬¦åˆèµåŠ©è§„åˆ™
3. ç­¾åç®¡ç†å™¨ç”Ÿæˆ paymaster ç­¾å
4. æ„é€ å¸¦æœ‰ paymaster æ•°æ®çš„ UserOperation
5. æäº¤åˆ° Rundler å†…å­˜æ± è¿›è¡Œæ‰“åŒ…å’Œä¸Šé“¾

### é…ç½®æ”¯æŒ
- CLI å‚æ•°: `--paymaster.enabled`, `--paymaster.policy-file`
- ç¯å¢ƒå˜é‡: `PAYMASTER_PRIVATE_KEY` ç”¨äºç­¾å
- TOML ç­–ç•¥é…ç½®æ–‡ä»¶æ”¯æŒ

### æ–‡ä»¶ç»“æ„
```
crates/paymaster-relay/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib.rs          # æ¨¡å—å®šä¹‰
â”‚   â”œâ”€â”€ rpc.rs          # JSON-RPC API
â”‚   â”œâ”€â”€ service.rs      # æ ¸å¿ƒæœåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ policy.rs       # ç­–ç•¥å¼•æ“
â”‚   â”œâ”€â”€ signer.rs       # ç­¾åç®¡ç†
â”‚   â”œâ”€â”€ error.rs        # é”™è¯¯ç±»å‹
â”‚   â”œâ”€â”€ api_docs.rs     # API æ–‡æ¡£å®šä¹‰
â”‚   â””â”€â”€ swagger.rs      # Swagger UI æœåŠ¡
â””â”€â”€ tests/
    â””â”€â”€ rpc_test.rs     # é›†æˆæµ‹è¯•
```

### ä¸‹ä¸€æ­¥è®¡åˆ’
- ç«¯åˆ°ç«¯æµ‹è¯•éªŒè¯
- ç­–ç•¥å¼•æ“åŠŸèƒ½æ‰©å±•
- å®‰å…¨æ€§å¢å¼º (KMS é›†æˆ)
- æ€§èƒ½ä¼˜åŒ–
- ç”Ÿäº§éƒ¨ç½²å‡†å¤‡

### å½±å“èŒƒå›´
- æ–°å¢æ–‡ä»¶: `crates/paymaster-relay/` ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶
- ä¿®æ”¹æ–‡ä»¶: `Cargo.toml` (æ·»åŠ  paymaster-relay åˆ°å·¥ä½œç©ºé—´)
- å½±å“åŠŸèƒ½: æ–°å¢ paymaster gas sponsorship åŠŸèƒ½ï¼Œä¸å½±å“ç°æœ‰ bundler åŠŸèƒ½ 

# SuperPaymasterå¼€å‘å˜æ›´è®°å½•

## ç‰ˆæœ¬å†å²

### ğŸ‰ v0.1.0 - SuperPaymasteræ ¸å¿ƒåŠŸèƒ½å®Œæˆ (2025-01-15)

**é‡å¤§é‡Œç¨‹ç¢‘è¾¾æˆ**ï¼šSuperPaymasteræ ¸å¿ƒåŠŸèƒ½å…¨é¢å®Œæˆå¹¶é€šè¿‡ç«¯åˆ°ç«¯æµ‹è¯•éªŒè¯ï¼

#### ğŸ—ï¸ æ ¸å¿ƒæ¶æ„å®ç°
- âœ… **PaymasterRelayService**: ERC-4337 PaymasteræœåŠ¡æ ¸å¿ƒé€»è¾‘
- âœ… **SignerManager**: ç§é’¥ç®¡ç†å’ŒUserOperationç­¾å
- âœ… **PolicyEngine**: çµæ´»çš„ç­–ç•¥å¼•æ“æ”¯æŒå¤šç§é…ç½®
- âœ… **JSON-RPC API**: å®Œæ•´çš„`pm_sponsorUserOperation` APIå®ç°
- âœ… **CLIé›†æˆ**: å‘½ä»¤è¡Œå‚æ•°å®Œæ•´æ”¯æŒ

#### ğŸ”§ æŠ€æœ¯é—®é¢˜è§£å†³
1. **CLIé›†æˆé—®é¢˜**
   - æ·»åŠ äº†`--paymaster.enabled`ï¼Œ`--paymaster.private_key`ï¼Œ`--paymaster.policy_file`å‚æ•°
   - ä¿®å¤äº†PaymasterRelayServiceåœ¨CLIä¸­æœªåˆå§‹åŒ–çš„é—®é¢˜

2. **APIæ³¨å†Œé—®é¢˜**
   - ä¿®å¤äº†"Method not found"é”™è¯¯
   - æ·»åŠ "paymaster"åˆ°æœ‰æ•ˆAPIå‘½åç©ºé—´
   - é»˜è®¤å¯ç”¨paymaster API

3. **å‚æ•°è§£æé—®é¢˜**
   - å®ç°äº†`parse_hex_or_decimal()`å‡½æ•°æ”¯æŒå¤šç§æ•°å­—æ ¼å¼
   - ä¿®å¤äº†UserOperation v0.6å’Œv0.7æ ¼å¼æ”¯æŒ
   - è§£å†³äº†hex/decimalå‚æ•°è½¬æ¢é—®é¢˜

4. **EntryPointé…ç½®**
   - åˆ›å»ºäº†åŠ¨æ€é“¾è§„èŒƒç”Ÿæˆè„šæœ¬
   - æ”¯æŒæœ¬åœ°éƒ¨ç½²çš„EntryPointåˆçº¦
   - ä¿®å¤äº†EntryPointåœ°å€éªŒè¯é€»è¾‘

#### ğŸ› ï¸ å¼€å‘å·¥å…·å®Œå–„
- **é‡å¯è„šæœ¬**: `scripts/restart_super_relay.sh` - å®Œæ•´çš„æœåŠ¡ç®¡ç†
- **èµ„é‡‘ç®¡ç†**: `scripts/fund_paymaster.sh` - Paymasterè´¦æˆ·èµ„é‡‘ç®¡ç†
- **ç«¯åˆ°ç«¯æµ‹è¯•**: `scripts/test_simple.sh` - æ ¸å¿ƒåŠŸèƒ½éªŒè¯
- **é“¾è§„èŒƒç”Ÿæˆ**: `scripts/generate_chain_spec.sh` - åŠ¨æ€é…ç½®æ”¯æŒ

#### ğŸ“‹ ç­–ç•¥é…ç½®ç³»ç»Ÿ
åˆ›å»ºäº†å®Œæ•´çš„`config/paymaster-policies.toml`åŒ…å«ï¼š
- é»˜è®¤ç­–ç•¥ã€å¼€å‘ç¯å¢ƒç­–ç•¥ã€ç”Ÿäº§ç¯å¢ƒç­–ç•¥
- æ¼”ç¤ºç­–ç•¥ã€åˆä½œä¼™ä¼´ç­–ç•¥ã€æµ‹è¯•ç­–ç•¥ã€ç´§æ€¥ç­–ç•¥
- çµæ´»çš„allowlist/denylistæ”¯æŒ
- Gasé™åˆ¶å’Œè´¹ç”¨æ§åˆ¶

#### ğŸ§ª æµ‹è¯•éªŒè¯ç»“æœ
ç«¯åˆ°ç«¯æµ‹è¯•è¯æ˜äº†ä»¥ä¸‹åŠŸèƒ½å®Œå…¨æ­£å¸¸ï¼š
- âœ… æœåŠ¡å¥åº·æ£€æŸ¥
- âœ… æ ‡å‡†RPCåŠŸèƒ½ (`eth_supportedEntryPoints`)
- âœ… Paymaster APIå¯ç”¨æ€§ (`pm_sponsorUserOperation`)
- âœ… UserOperationæ ¼å¼è§£æï¼ˆv0.6/v0.7ï¼‰
- âœ… EntryPointåœ°å€éªŒè¯
- âœ… é”™è¯¯å¤„ç†å’Œå‚æ•°éªŒè¯
- âœ… ä»APIæ³¨å†Œåˆ°ä¸šåŠ¡é€»è¾‘çš„å®Œæ•´æµç¨‹

#### ğŸ” å…³é”®æŠ€æœ¯æˆå°±
1. **APIé›†æˆå®Œæˆ**: ä»"-32601 Method not found"åˆ°æ­£ç¡®çš„ä¸šåŠ¡é€»è¾‘é”™è¯¯
2. **å‚æ•°è§£æå¥å£®**: æ”¯æŒhex(0xå‰ç¼€)å’Œdecimalä¸¤ç§æ ¼å¼
3. **æ¶æ„éªŒè¯æˆåŠŸ**: PaymasterRelayService â†’ SignerManager â†’ PolicyEngineå®Œæ•´æµç¨‹
4. **æœåŠ¡ç®¡ç†è‡ªåŠ¨åŒ–**: ä¸€é”®é‡å¯ã€éƒ¨ç½²ã€æµ‹è¯•çš„å®Œæ•´å·¥å…·é“¾

#### ğŸ“Š ç³»ç»ŸçŠ¶æ€
- **æœåŠ¡çŠ¶æ€**: âœ… è¿è¡Œæ­£å¸¸
- **APIçŠ¶æ€**: âœ… å®Œå…¨å¯ç”¨
- **æµ‹è¯•è¦†ç›–**: âœ… æ ¸å¿ƒåŠŸèƒ½å…¨è¦†ç›–
- **æ–‡æ¡£çŠ¶æ€**: âœ… åŒæ­¥æ›´æ–°

#### ğŸ¯ è¾¾æˆçš„Features
æ ¹æ®`Features.md`ä¸­å®šä¹‰çš„æ ¸å¿ƒåŠŸèƒ½ï¼š
- [x] **F1**: ERC-4337 PaymasteræœåŠ¡
- [x] **F2**: UserOperationç­¾åå’ŒéªŒè¯
- [x] **F3**: çµæ´»çš„ç­–ç•¥å¼•æ“
- [x] **F4**: JSON-RPC APIæ¥å£
- [x] **F5**: å¤šç‰ˆæœ¬EntryPointæ”¯æŒ
- [x] **F6**: å®‰å…¨çš„ç§é’¥ç®¡ç†
- [x] **F7**: é…ç½®åŒ–çš„ç­–ç•¥ç®¡ç†

#### ğŸš€ å®Œæˆçš„é«˜çº§åŠŸèƒ½
1. âœ… **EntryPointèµ„é‡‘å……å€¼è‡ªåŠ¨åŒ–**: å®Œæ•´çš„èµ„é‡‘ç®¡ç†ç³»ç»Ÿ
2. âœ… **ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²é…ç½®**: ä¼ä¸šçº§é…ç½®æ–‡ä»¶
3. âœ… **Demoåº”ç”¨å¼€å‘**: å®Œæ•´çš„åŠŸèƒ½æ¼”ç¤º
4. âœ… **è‡ªåŠ¨åŒ–å·¥å…·é“¾**: ä¸€é”®éƒ¨ç½²å’Œæµ‹è¯•

#### ğŸ“ˆ v0.1.1 å¢å¼ºåŠŸèƒ½ (2025-01-15)

**ğŸ¦ EntryPointèµ„é‡‘ç®¡ç†è‡ªåŠ¨åŒ–**:
- æ™ºèƒ½è´¦æˆ·ä½™é¢ç›‘æ§å’Œè‡ªåŠ¨å……å€¼
- å¤šå‘½ä»¤è¡Œå·¥å…·ï¼š`status`, `fund`, `deposit`, `auto-rebalance`, `monitor`
- å®æ—¶ç›‘æ§æ¨¡å¼æ”¯æŒï¼Œå¯è®¾å®šæ£€æŸ¥é—´éš”
- ç´§æ€¥èµ„é‡‘æ¨¡å¼ï¼Œå¿«é€Ÿæ¢å¤æœåŠ¡
- å¥åº·çŠ¶æ€æ£€æŸ¥å’ŒæŠ¥è­¦ç³»ç»Ÿ

**ğŸ­ ç”Ÿäº§ç¯å¢ƒé…ç½®å®Œå–„**:
- ä¼ä¸šçº§ç”Ÿäº§é…ç½®æ–‡ä»¶ `config/production.toml`
- å¤šå±‚çº§ç­–ç•¥ç³»ç»Ÿï¼šdefault, enterprise, premium, partner
- AWS KMSé›†æˆæ”¯æŒå®‰å…¨å¯†é’¥ç®¡ç†
- å…¨é¢çš„ç›‘æ§ã€æ—¥å¿—å’Œå‘Šè­¦é…ç½®
- åˆè§„æ€§å’ŒAMLæ”¯æŒæ¡†æ¶

**ğŸ¬ Demoåº”ç”¨å’Œè‡ªåŠ¨åŒ–**:
- å®Œæ•´çš„Node.jsæ¼”ç¤ºåº”ç”¨ `demo/superPaymasterDemo.js`
- 5ä¸ªæ ¸å¿ƒæµ‹è¯•åœºæ™¯éªŒè¯æ‰€æœ‰åŠŸèƒ½
- è‡ªåŠ¨åŒ–æ¼”ç¤ºè¿è¡Œå™¨ `scripts/run_demo.sh`
- äº¤äº’å¼æ¼”ç¤ºæ¨¡å¼æ”¯æŒ
- å®Œæ•´çš„å¼€å‘è€…æ–‡æ¡£å’Œä½¿ç”¨ç¤ºä¾‹

#### ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’
1. ç›‘æ§å’Œæ—¥å¿—ç³»ç»Ÿé›†æˆï¼ˆPrometheus/Grafanaï¼‰
2. æ€§èƒ½ä¼˜åŒ–å’Œå‹åŠ›æµ‹è¯•
3. å¤šé“¾æ”¯æŒæ‰©å±•
4. é«˜å¯ç”¨éƒ¨ç½²æ–¹æ¡ˆ

---

### v0.0.1 - é¡¹ç›®åˆå§‹åŒ– (2025-01-15)
- é¡¹ç›®åŸºç¡€ç»“æ„æ­å»º
- Rustä»£ç æ¡†æ¶å®ç°
- åŸºç¡€æµ‹è¯•ç”¨ä¾‹åˆ›å»º 