# Changes Log

æœ¬æ–‡æ¡£è®°å½• SuperPaymaster é¡¹ç›®çš„å¼€å‘å†ç¨‹å’Œç‰ˆæœ¬å˜æ›´ã€‚

## é¡¹ç›®çŠ¶æ€åˆ†æ (å½“å‰çŠ¶æ€ - 2024-07-02)

### é¡¹ç›®æ¦‚å†µ
**SuperPaymaster** æ˜¯ä¸€ä¸ªå®Œæ•´çš„ ERC-4337 Paymaster è§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼š
1. **super-relay** (æœ¬é¡¹ç›®) - Paymaster ä¸­ç»§æœåŠ¡
2. **SuperPaymaster åˆçº¦** (ç‹¬ç«‹ repo) - æ™ºèƒ½åˆçº¦å±‚

### å½“å‰å¼€å‘è¿›å±•
#### super-relay åŠŸèƒ½å®Œæˆåº¦
- âœ… **Paymaster ç­¾å**: æ”¯æŒåŸºäº ERC4337 è§„æ ¼çš„ UserOperation è¯·æ±‚ï¼ˆå•ä¸ªæˆ–æ‰¹é‡ï¼‰ï¼Œè¿”å›å¸¦æœ‰ paymasterAndData çš„ç­¾å
- âœ… **Bundler æäº¤**: æ”¶åˆ°å¸¦æœ‰ç­¾åçš„ UserOperationï¼Œè‡ªå·±æ”¯ä»˜ gasï¼Œé€šè¿‡ RPC ä¸Šé“¾ï¼Œæäº¤ç»™ EntryPoint æ‰§è¡Œ
- âœ… **å…¼å®¹æ€§**: æ”¯æŒ EntryPoint v0.6, v0.7ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰ï¼Œä¸º v0.8 åšå¥½å‡†å¤‡
- âœ… **ç­–ç•¥å¼•æ“**: åŸºäº TOML é…ç½®çš„èµåŠ©ç­–ç•¥ï¼Œæ”¯æŒå¤šç§Ÿæˆ·ç®¡ç†
- âœ… **æ¨¡å—åŒ–è®¾è®¡**: åœ¨ä¸ä¿®æ”¹ Rundler æ ¸å¿ƒä»£ç åŸºç¡€ä¸Šæ‰©å±•åŠŸèƒ½

#### æŠ€æœ¯æ ˆéªŒè¯
- âœ… **ç¼–è¯‘ç³»ç»Ÿ**: Cargo workspace é…ç½®æ­£ç¡®ï¼Œæ‰€æœ‰ä¾èµ–è§£ææˆåŠŸ
- âœ… **RPC æ¥å£**: JSON-RPC API å®ç°å®Œæˆï¼Œæ”¯æŒ `pm_sponsorUserOperation` æ–¹æ³•
- âœ… **å¼‚æ­¥æ¶æ„**: åŸºäº Tokio runtimeï¼Œæ€§èƒ½ä¼˜åŒ–
- âœ… **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯ç±»å‹å®šä¹‰å’Œå¤„ç†æœºåˆ¶

#### å¾…å®Œæˆå·¥ä½œ
- ğŸ”„ **é›†æˆæµ‹è¯•**: éœ€è¦ä¿®å¤æµ‹è¯•ä¸­çš„åºåˆ—åŒ–é—®é¢˜
- ğŸ”„ **åˆçº¦é›†æˆ**: ç­‰å¾… SuperPaymaster åˆçº¦å®Œæˆåè¿›è¡Œè”åˆæµ‹è¯•
- ğŸ“ **æ–‡æ¡£å®Œå–„**: API æ–‡æ¡£å’Œç”¨æˆ·æŒ‡å—

### æŠ€æœ¯é£é™©è¯„ä¼°
- **ä½é£é™©**: Rundler åŸºç¡€æ¶æ„ç¨³å®šï¼Œæ ¸å¿ƒ paymaster åŠŸèƒ½å®ç°å®Œæ•´
- **ä¸­é£é™©**: ERC-4337 è§„èŒƒæ›´æ–°å¯èƒ½éœ€è¦é€‚é…ï¼Œç‰¹åˆ«æ˜¯ EntryPoint v0.8
- **ç®¡æ§æªæ–½**: ä¿æŒæ¨¡å—åŒ–è®¾è®¡ï¼Œç¡®ä¿å¯ä»¥å¿«é€Ÿé€‚é…æ–°ç‰ˆæœ¬

### ä¸‹é˜¶æ®µç›®æ ‡
1. å®Œæˆæµ‹è¯•ä¿®å¤å’ŒéªŒè¯
2. ä¸ SuperPaymaster åˆçº¦è¿›è¡Œé›†æˆæµ‹è¯•
3. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‡†å¤‡
4. å¤šç½‘ç»œå…¼å®¹æ€§æµ‹è¯•

---

## Version 0.0.3 - Compilation Fixes & Testing (2024-07-02)

### å·²è§£å†³é—®é¢˜
- ä¿®å¤ paymaster-relay æ¨¡å—ç¼–è¯‘é”™è¯¯
- ä¿®å¤ JsonRPC ç‰¹æ€§é…ç½®é—®é¢˜ï¼Œæ·»åŠ  "client", "ws-client" ç‰¹æ€§
- ä¿®å¤ UserOperationVariant åºåˆ—åŒ–é—®é¢˜ï¼Œå®ç° JSON è½¬æ¢
- ä¿®å¤æµ‹è¯•æ–‡ä»¶ä¸­çš„å¯¼å…¥è·¯å¾„é—®é¢˜
- ä¿®å¤ policy.rs ä¸­ç§æœ‰å­—æ®µè®¿é—®é—®é¢˜ï¼Œä½¿ç”¨ UserOperationBuilder
- ä¿®å¤æµ‹è¯•æ–‡ä»¶ä¸­ UserOperationVariant åºåˆ—åŒ–é—®é¢˜ï¼Œæ”¹ç”¨ JSON æ ¼å¼

### æŠ€æœ¯æ”¹è¿›
- å®ç° JsonUserOperation åˆ° UserOperationVariant çš„å®Œæ•´è½¬æ¢é€»è¾‘
- æ”¯æŒ EntryPoint v0.6 å’Œ v0.7 çš„è‡ªåŠ¨è¯†åˆ«å’Œè½¬æ¢
- ä¼˜åŒ–é”™è¯¯å¤„ç†ï¼Œæä¾›è¯¦ç»†çš„è½¬æ¢é”™è¯¯ä¿¡æ¯
- æ”¹è¿›ä»£ç ç»“æ„ï¼Œå»é™¤æœªä½¿ç”¨çš„ Swagger UI ä¾èµ–

### æµ‹è¯•éªŒè¯
- âœ… Rundler åŸæœ‰åŠŸèƒ½æµ‹è¯•å…¨éƒ¨é€šè¿‡ (297 tests passed)  
- âœ… Paymaster-relay ç¼–è¯‘å®Œå…¨æˆåŠŸï¼Œæ— ç¼–è¯‘é”™è¯¯
- âœ… Paymaster-relay å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡ (3 tests passed)
- âœ… æ•´ä½“é¡¹ç›® Release ç¼–è¯‘æˆåŠŸï¼Œç”Ÿäº§å°±ç»ª
- âœ… ç¡®è®¤æ–°å¢åŠŸèƒ½ä¸å½±å“åŸæœ‰ç³»ç»Ÿç¨³å®šæ€§

### å½±å“èŒƒå›´
- ä¿®æ”¹æ–‡ä»¶: `crates/paymaster-relay/Cargo.toml` (æ·»åŠ  jsonrpsee ç‰¹æ€§)
- ä¿®æ”¹æ–‡ä»¶: `crates/paymaster-relay/src/rpc.rs` (é‡æ„ JSON è½¬æ¢é€»è¾‘)
- ä¿®æ”¹æ–‡ä»¶: `crates/paymaster-relay/src/policy.rs` (ä¿®å¤æµ‹è¯•ä»£ç )
- åˆ é™¤æ–‡ä»¶: Swagger UI ç›¸å…³æ–‡ä»¶ (ç®€åŒ–ä¾èµ–)
- å½±å“åŠŸèƒ½: JSON-RPC æ¥å£ä¼˜åŒ–ï¼Œæµ‹è¯•ç¨³å®šæ€§æå‡

### åŒ…åç¡®è®¤
- åŒ…å `rundler-paymaster-relay` æ­£ç¡®é…ç½®
- æµ‹è¯•å‘½ä»¤: `cargo test --package rundler-paymaster-relay` å¯æ­£å¸¸è¯†åˆ«

---

## Version 0.0.2 - Bug Fixes & Integration (2024-07-02)

### å·²è§£å†³é—®é¢˜
- ä¿®å¤ git å­æ¨¡å—é—®é¢˜ (fastlz/fastlz.c æ–‡ä»¶ç¼ºå¤±)
- ä¿®å¤ workspace ä¾èµ–é…ç½®é—®é¢˜
- å°† paymaster-relay æ­£ç¡®é›†æˆåˆ°ä¸» workspace
- æ·»åŠ ç¼ºå¤±çš„ workspace ä¾èµ–: axum, utoipa, utoipa-swagger-ui, ethers, jsonrpsee-core, jsonrpsee-ws-client
- å®Œæˆé¡¹ç›®ç¼–è¯‘éªŒè¯ (Debug å’Œ Release æ¨¡å¼)

### æ–‡æ¡£å®Œå–„
- åˆ›å»º `Changes.md` - ç‰ˆæœ¬å˜æ›´è®°å½•
- åˆ›å»º `Deploy.md` - å®Œæ•´çš„éƒ¨ç½²å’Œç»´æŠ¤æŒ‡å—

### æµ‹è¯•çŠ¶æ€
- é¡¹ç›®ç¼–è¯‘æˆåŠŸ âœ…
- ä¾èµ–é…ç½®æ­£ç¡® âœ…
- å‡†å¤‡è¿›è¡ŒåŠŸèƒ½æµ‹è¯•

### æŠ€æœ¯æ”¹è¿›
- workspace é…ç½®ä¼˜åŒ–
- ä¾èµ–ç‰ˆæœ¬ç»Ÿä¸€ç®¡ç†
- ç¼–è¯‘æµç¨‹ç¨³å®š

---

## Version 0.0.1 - Initial Development (2024-07-02)

### æ–°å¢åŠŸèƒ½
- åˆ›å»º `paymaster-relay` crate ä½œä¸ºç‹¬ç«‹æ¨¡å—
- å®ç° `SignerManager` - æ”¯æŒæœ¬åœ°ç§é’¥ç­¾åç®¡ç†
- å®ç° `PolicyEngine` - åŸºäº TOML é…ç½®çš„èµåŠ©ç­–ç•¥å¼•æ“
- å®ç° `PaymasterRelayApi` - JSON-RPC æ¥å£ï¼Œæä¾› `pm_sponsorUserOperation` æ–¹æ³•
- å®ç° `PaymasterRelayService` - æ ¸å¿ƒä¸šåŠ¡é€»è¾‘æœåŠ¡
- é›†æˆ Swagger UI - è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£
- æ·»åŠ å®Œæ•´çš„é”™è¯¯å¤„ç†æœºåˆ¶

### æŠ€æœ¯æ¶æ„
- åŸºäº Rundler (Alchemy ERC-4337 bundler) æ¶æ„
- æ”¯æŒ EntryPoint v0.6 å’Œ v0.7
- æ¨¡å—åŒ–è®¾è®¡ï¼Œä¸å½±å“ Rundler åŸæœ‰åŠŸèƒ½
- å¼‚æ­¥å¤„ç†æ¶æ„ï¼ŒåŸºäº Tokio runtime

### æ ¸å¿ƒåŠŸèƒ½æµç¨‹
1. å®¢æˆ·ç«¯è°ƒç”¨ `pm_sponsorUserOperation`
2. ç­–ç•¥å¼•æ“éªŒè¯ UserOperation æ˜¯å¦ç¬¦åˆèµåŠ©è§„åˆ™
3. ç­¾åç®¡ç†å™¨ç”Ÿæˆ paymaster ç­¾å
4. æ„é€ å¸¦æœ‰ paymaster æ•°æ®çš„ UserOperation
5. æäº¤åˆ° Rundler å†…å­˜æ± è¿›è¡Œæ‰“åŒ…å’Œä¸Šé“¾

### é…ç½®æ”¯æŒ
- CLI å‚æ•°: `--paymaster.enabled`, `--paymaster.policy-file`
- ç¯å¢ƒå˜é‡: `PAYMASTER_PRIVATE_KEY` ç”¨äºç­¾å
- TOML ç­–ç•¥é…ç½®æ–‡ä»¶æ”¯æŒ

### æ–‡ä»¶ç»“æ„
```
crates/paymaster-relay/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ lib.rs          # æ¨¡å—å®šä¹‰
â”‚   â”œâ”€â”€ rpc.rs          # JSON-RPC API
â”‚   â”œâ”€â”€ service.rs      # æ ¸å¿ƒæœåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ policy.rs       # ç­–ç•¥å¼•æ“
â”‚   â”œâ”€â”€ signer.rs       # ç­¾åç®¡ç†
â”‚   â”œâ”€â”€ error.rs        # é”™è¯¯ç±»å‹
â”‚   â”œâ”€â”€ api_docs.rs     # API æ–‡æ¡£å®šä¹‰
â”‚   â””â”€â”€ swagger.rs      # Swagger UI æœåŠ¡
â””â”€â”€ tests/
    â””â”€â”€ rpc_test.rs     # é›†æˆæµ‹è¯•
```

### ä¸‹ä¸€æ­¥è®¡åˆ’
- ç«¯åˆ°ç«¯æµ‹è¯•éªŒè¯
- ç­–ç•¥å¼•æ“åŠŸèƒ½æ‰©å±•
- å®‰å…¨æ€§å¢å¼º (KMS é›†æˆ)
- æ€§èƒ½ä¼˜åŒ–
- ç”Ÿäº§éƒ¨ç½²å‡†å¤‡

### å½±å“èŒƒå›´
- æ–°å¢æ–‡ä»¶: `crates/paymaster-relay/` ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶
- ä¿®æ”¹æ–‡ä»¶: `Cargo.toml` (æ·»åŠ  paymaster-relay åˆ°å·¥ä½œç©ºé—´)
- å½±å“åŠŸèƒ½: æ–°å¢ paymaster gas sponsorship åŠŸèƒ½ï¼Œä¸å½±å“ç°æœ‰ bundler åŠŸèƒ½ 